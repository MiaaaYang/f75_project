getwd()
setwd("/Users/nazizanaeer/Documents/EPI_550/Homework/HW7")
library(readr)
vets <- read.csv("vets")
library("haven")
install.packages("haven")
library("haven")
vets <- read_sas("vets.sas7dat")
vets <- read_sas("vets.sas7bdat")
library(survival)
install.packages("survival")
install.packages("survminer")
library(survival)
library(survminer)
test_tx <- survfit(Surv(SURVT, STATUS) ~ TX, data = vets)
ggsurvplot(test_tx, fun="cloglog") +
ggtot;e("Log of Negative Log of Estimate Survivor Functions")
ggsurvplot(test_tx, fun="cloglog") +
ggtitle("Log of Negative Log of Estimate Survivor Functions")
ggsurvplot(test_tx, fun="cloglog") +
ggtitle("Log of Negative Log of Estimate Survivor Functions")
ggsurvplot(test_tx, fun="cloglog") +
ggtitle("Log of Negative Log of Estimate Survivor Functions")
ggsurvplot(test_tx, fun="cloglog")
ggtitle("Log of Negative Log of Estimate Survivor Functions")
ggsurvplot(test_tx, fun="cloglog") +
ggtitle("Log of Negative Log of Estimate Survivor Functions")
g <- ggsurvplot(test_tx, fun="cloglog") +
ggtitle("Log of Negative Log of Estimate Survivor Functions")
g$plot + ggtitle("Log of Negative Log of Estimate Survivor Functions")
ggsurvplot(test_tx, fun="cloglog")
View(vets)
View(vets)
test_age <- survfit(Surv(SURVT, STATUS) ~ AGE, vets)
View(test_age)
ggsurvplot(test_age, fun="cloglog")
quantile(vets$AGE, c(0.25,0.5,0.75))
quantile(vets$AGE, c0,0.25,0.5,0.75,1))
quantile(vets$AGE, c(0,0.25,0.5,0.75,1))
vets$AGE_grp <- cut(
vets$AGE,
breaks = quantile(vets$AGE, probs = c(0, 0.25, 0.5, 0.75, 1), na.rm = TRUE),
include.lowest = TRUE,
labels = c("Q1 (youngest)", "Q2", "Q3", "Q4 (oldest)")
)
test_age <- survfit(Surv(SURVT, STATUS) ~ AGE_grp, vets)
ggsurvplot(test_age, fun="cloglog")
vets$AGE_grp <- cut(
vets$AGE,
breaks = quantile(vets$AGE, probs = c(0.25, 0.5, 0.75), na.rm = TRUE),
include.lowest = TRUE,
labels = c(51, 62, 66)
)
vets$AGE_grp <- cut(
vets$AGE,
breaks = quantile(vets$AGE, probs = c(0.25, 0.5, 0.75), na.rm = TRUE),
include.lowest = TRUE,
labels = c("Q1=51", "Q2=62", "Q3=66")
)
test_age <- survfit(Surv(SURVT, STATUS) ~ AGE_grp, vets)
ggsurvplot(test_age, fun="cloglog")
vets$AGE_grp <- cut(
vets$AGE,
breaks = quantile(vets$AGE, probs = c(0.25, 0.5, 0.75), na.rm = TRUE),
include.lowest = TRUE,
labels = c("Q1=51", "Q2=62", "Q3=66")
)
vets$AGE_grp <- cut(
vets$AGE,
breaks = quantile(vets$AGE, probs = c(0.25, 0.5, 0.75), na.rm = TRUE),
include.lowest = TRUE
)
test_age <- survfit(Surv(SURVT, STATUS) ~ AGE_grp, vets)
ggsurvplot(test_age, fun="cloglog")
test_priortx <- survfit(Surv(SURVT, STATUS) ~ PRIORTX, data = vets)
ggsurvplot(test_priortx, fun="cloglog")
median(vets$AGE)
library(dplyr)
vets <- vets %>% mutate(AGE_tertile = ntile(AGE, 3))
test_age_tert <- survfit(Surv(SURVT, STATUS) ~ AGE_tertile, vets)
ggsurvplot(test_age_tert, fun="cloglog")
gof_tx <- coxph(Surv(SURVT, STATUS) ~ TX, vets, ties = "breslow")
cox.zph(gof_tx)
gof_age <- coxph(Surv(SURVT, STATUS) ~ AGE, vets, ties = "breslow")
cox.zph(gof_age)
gof_priortx <- coxph(Surv(SURVT, STATUS) ~ PRIORTX, vets, ties = "breslow")
cox.zph(gof_priortx)
coxph(Surv(SURVT, STATUS) ~ TC + tt(TX),
vets, "breslow", tt = function(x, t, ...) as.numeric(x)*t)
coxph(Surv(SURVT, STATUS) ~ TX + tt(TX),
vets, "breslow", tt = function(x, t, ...) as.numeric(x)*t)
coxph(Surv(SURVT, STATUS) ~ TX + tt(TX),
vets, ties = "breslow", tt = function(x, t, ...) as.numeric(x)*t)
# g(t) = ln(t)
coxph(Surv(SURVT, STATUS) ~ TX + tt(TX),
vets, ties = "breslow", tt = function(x, t, ...) as.numeric(x)*log(t))
# g(t) = t
coxph(Surv(SURVT, STATUS) ~ AGE + tt(AGE),
vets, ties = "breslow", tt = function(x, t, ...) as.numeric(x)*t)
# g(t) = ln(t)
coxph(Surv(SURVT, STATUS) ~ AGE + tt(AGE),
vets, ties = "breslow", tt = function(x, t, ...) as.numeric(x)*log(t))
# g(t) = t
coxph(Surv(SURVT, STATUS) ~ PRIORTX + tt(PRIORTX),
vets, ties = "breslow", tt = function(x, t, ...) as.numeric(x)*t)
# g(t) = ln(t)
coxph(Surv(SURVT, STATUS) ~ PRIORTX + tt(PRIORTX),
vets, ties = "breslow", tt = function(x, t, ...) as.numeric(x)*log(t))
vets <- vets %>% mutate(AGE_tertile = ntile(AGE, 3))
table(vets$AGE_tertile)
test_age_tert <- survfit(Surv(SURVT, STATUS) ~ AGE_tertile, vets)
ggsurvplot(test_age_tert, fun="cloglog")
vets$AGE_grp <- cut(
vets$AGE,
breaks = quantile(vets$AGE, probs = c(0.25, 0.5, 0.75), na.rm = TRUE),
include.lowest = TRUE
)
test_age <- survfit(Surv(SURVT, STATUS) ~ AGE_grp, vets)
ggsurvplot(test_age, fun="cloglog")
vets <- vets %>%
mutate(AGE_group2 = ifelse(AGE <= median(AGE, na.rm = TRUE)))
vets <- vets %>%
mutate(AGE_group2 = ifelse(AGE <= median(AGE, na.rm = TRUE),
"Younger (≤ median)", "Older (> median)"))
table(vets$AGE_group2)
test_age_grp2 <- survfit(Surv(SURVT, STATUS) ~ AGE_group2, vets)
ggsurvplot(test_age_grp2, fun="cloglog")
vets <- vets %>%
mutate(AGE_group2 = ifelse(AGE <= median(AGE, na.rm = TRUE),
1,2))
table(vets$AGE_group2)
test_age_grp2 <- survfit(Surv(SURVT, STATUS) ~ AGE_group2, vets)
ggsurvplot(test_age_grp2, fun="cloglog")
vets$AGE_grp <- cut(
vets$AGE,
breaks = quantile(vets$AGE, probs = c(0.25, 0.5, 0.75), na.rm = TRUE),
include.lowest = TRUE
)
vets$AGE_grp
median(vets$AGE)
vets <- vets %>%
mutate(AGE_group2 = ifelse(AGE <= median(AGE, na.rm = TRUE),
"≤62",">62"))
table(vets$AGE_group2)
test_age_grp2 <- survfit(Surv(SURVT, STATUS) ~ AGE_group2, vets)
ggsurvplot(test_age_grp2, fun="cloglog")
cox_crude <- coxph(Surv(SURVT, STATUS) ~ PRIORTX, data = vets)
summary(cox_crude)
cox_adj <- coxph(Surv(SURVT, STATUS) ~ PRIORTX + AGE, data = vets)
summary(cox_adj)
